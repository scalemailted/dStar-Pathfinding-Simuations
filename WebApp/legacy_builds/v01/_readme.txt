This is far too complex an not working